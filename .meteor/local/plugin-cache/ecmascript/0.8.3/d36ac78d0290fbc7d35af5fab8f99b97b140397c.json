{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/practicalmeteor:mocha/test/utils.js","filenameRelative":"packages/practicalmeteor:mocha/test/utils.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/practicalmeteor:mocha/test/utils.js.map","sourceFileName":"packages/practicalmeteor:mocha/test/utils.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"utils"},"ignored":false,"code":"var mocha = require('..');\n\nvar utils = mocha.utils;\ndescribe('utils', function () {\n  describe('.clean()', function () {\n    var clean = utils.clean;\n    it('should remove the wrapping function declaration', function () {\n      clean('function  (one, two, three)  {\\n//code\\n}').should.equal('//code');\n    });\n    it('should handle newlines in the function declaration', function () {\n      clean('function  (one, two, three)\\n  {\\n//code\\n}').should.equal('//code');\n    });\n    it('should remove space character indentation from the function body', function () {\n      clean('  //line1\\n    //line2').should.equal('//line1\\n  //line2');\n    });\n    it('should remove tab character indentation from the function body', function () {\n      clean('\\t//line1\\n\\t\\t//line2').should.equal('//line1\\n\\t//line2');\n    });\n  });\n  describe('.isBuffer()', function () {\n    var isBuffer = utils.isBuffer;\n    it('should test if object is a Buffer', function () {\n      isBuffer(new Buffer([0x01])).should.equal(true);\n      isBuffer({}).should.equal(false);\n    });\n  });\n  describe('.map()', function () {\n    var map = utils.map;\n    it('should behave same as Array.prototype.map', function () {\n      var arr = [1, 2, 3];\n      map(arr, JSON.stringify).should.eql(arr.map(JSON.stringify));\n    });\n    it('should call the callback with 3 arguments[currentValue, index, array]', function () {\n      var index = 0;\n      map([1, 2, 3], function (e, i, arr) {\n        e.should.equal(arr[index]);\n        i.should.equal(index++);\n      });\n    });\n    it('should apply with the given scope', function () {\n      var scope = {};\n      map(['a', 'b', 'c'], function () {\n        this.should.equal(scope);\n      }, scope);\n    });\n  });\n  describe('.parseQuery()', function () {\n    var parseQuery = utils.parseQuery;\n    it('should get queryString and return key-value object', function () {\n      parseQuery('?foo=1&bar=2&baz=3').should.eql({\n        foo: '1',\n        bar: '2',\n        baz: '3'\n      });\n      parseQuery('?r1=^@(?!.*\\\\)$)&r2=m{2}&r3=^co.*').should.eql({\n        r1: '^@(?!.*\\\\)$)',\n        r2: 'm{2}',\n        r3: '^co.*'\n      });\n    });\n  });\n  describe('.stackTraceFilter()', function () {\n    describe('on node', function () {\n      var filter = utils.stackTraceFilter();\n      it('should get a stack-trace as a string and prettify it', function () {\n        var stack = ['AssertionError: foo bar', 'at EventEmitter.<anonymous> (/usr/local/dev/test.js:16:12)', 'at Context.<anonymous> (/usr/local/dev/test.js:19:5)', 'Test.Runnable.run (/usr/local/lib/node_modules/mocha/lib/runnable.js:244:7)', 'Runner.runTest (/usr/local/lib/node_modules/mocha/lib/runner.js:374:10)', '/usr/local/lib/node_modules/mocha/lib/runner.js:452:12', 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:299:14)', '/usr/local/lib/node_modules/mocha/lib/runner.js:309:7', 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:248:23)', 'Immediate._onImmediate (/usr/local/lib/node_modules/mocha/lib/runner.js:276:5)', 'at processImmediate [as _immediateCallback] (timers.js:321:17)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0, 3).join('\\n'));\n        stack = ['AssertionError: bar baz', 'at /usr/local/dev/some-test-file.js:25:8', 'at tryCatcher (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/util.js:24:31)', 'at Promise._resolveFromResolver (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/promise.js:439:31)', 'at new Promise (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/promise.js:53:37)', 'at yourFunction (/usr/local/dev/own/tmp/test1.js:24:13)', 'at Context.<anonymous> (/usr/local/dev/some-test-file:30:4)', 'Test.Runnable.run (/usr/local/lib/node_modules/mocha/lib/runnable.js:218:15)', 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:248:23)', 'Immediate._onImmediate (/usr/local/lib/node_modules/mocha/lib/runner.js:276:5)', 'at processImmediate [as _immediateCallback] (timers.js:321:17)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0, 7).join('\\n'));\n      });\n      it('does not ignore other bower_components and components', function () {\n        var stack = ['Error: failed', 'at assert (index.html:11:26)', 'at Context.<anonymous> (test.js:17:18)', 'at bower_components/should/should.js:4827:7', 'at next (file:///.../bower_components/should/should.js:4766:23)', 'at components/should/5.0.0/should.js:4827:7', 'at next (file:///.../components/should/5.0.0/should.js:4766:23)', 'at file:///.../bower_components/mocha/mocha.js:4794:5', 'at timeslice (.../components/mocha/mocha.js:6218:27)', 'at Test.require.register.Runnable.run (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4463:15)', 'at Runner.require.register.Runner.runTest (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4892:10)', 'at file:///.../components/mochajs/mocha/2.1.0/mocha.js:4970:12', 'at next (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4817:14)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0, 7).join('\\n'));\n      });\n    });\n    describe('on browser', function () {\n      var filter;\n      before(function () {\n        global.document = true;\n        global.location = {\n          href: 'localhost:3000/foo/bar/index.html'\n        };\n        filter = utils.stackTraceFilter();\n      });\n      it('does not strip out other bower_components and components', function () {\n        var stack = ['Error: failed', 'at assert (index.html:11:26)', 'at Context.<anonymous> (test.js:17:18)', 'at bower_components/should/should.js:4827:7', 'at next (bower_components/should/should.js:4766:23)', 'at components/should/5.0.0/should.js:4827:7', 'at next (components/should/5.0.0/should.js:4766:23)', 'at Runner.require.register.Runner.runTest (node_modules/mocha.js:4892:10)', 'at localhost:3000/foo/bar/node_modules/mocha.js:4970:12', 'at next (node_modules/mocha.js:4817:14)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0, 7).join('\\n'));\n      });\n      after(function () {\n        delete global.document;\n        delete global.location;\n      });\n    });\n  });\n});","map":{"version":3,"sources":["packages/practicalmeteor:mocha/test/utils.js"],"names":["mocha","require","utils","describe","clean","it","should","equal","isBuffer","Buffer","map","arr","JSON","stringify","eql","index","e","i","scope","parseQuery","foo","bar","baz","r1","r2","r3","filter","stackTraceFilter","stack","join","slice","before","global","document","location","href","after"],"mappings":"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","file":"packages/practicalmeteor:mocha/test/utils.js.map","sourcesContent":["var mocha = require('..');\nvar utils = mocha.utils;\n\ndescribe('utils', function() {\n  describe('.clean()', function() {\n    var clean = utils.clean;\n    it('should remove the wrapping function declaration', function() {\n      clean('function  (one, two, three)  {\\n//code\\n}').should.equal('//code');\n    });\n\n    it('should handle newlines in the function declaration', function() {\n      clean('function  (one, two, three)\\n  {\\n//code\\n}').should.equal('//code');\n    });\n\n    it('should remove space character indentation from the function body', function() {\n      clean('  //line1\\n    //line2').should.equal('//line1\\n  //line2');\n    });\n\n    it('should remove tab character indentation from the function body', function() {\n      clean('\\t//line1\\n\\t\\t//line2').should.equal('//line1\\n\\t//line2');\n    });\n  });\n\n  describe('.isBuffer()', function() {\n    var isBuffer = utils.isBuffer;\n    it('should test if object is a Buffer', function() {\n      isBuffer(new Buffer([0x01])).should.equal(true);\n      isBuffer({}).should.equal(false);\n    })\n  });\n\n  describe('.map()', function() {\n    var map = utils.map;\n    it('should behave same as Array.prototype.map', function() {\n      var arr = [1, 2, 3];\n      map(arr, JSON.stringify).should.eql(arr.map(JSON.stringify));\n    });\n\n    it('should call the callback with 3 arguments[currentValue, index, array]', function() {\n      var index = 0;\n      map([1, 2, 3], function(e, i, arr) {\n        e.should.equal(arr[index]);\n        i.should.equal(index++);\n      })\n    });\n\n    it('should apply with the given scope', function() {\n      var scope = {};\n      map(['a', 'b', 'c'], function() {\n        this.should.equal(scope);\n      }, scope);\n    });\n  });\n\n  describe('.parseQuery()', function() {\n    var parseQuery = utils.parseQuery;\n    it('should get queryString and return key-value object', function() {\n      parseQuery('?foo=1&bar=2&baz=3').should.eql({\n        foo: '1',\n        bar: '2',\n        baz: '3'\n      });\n\n      parseQuery('?r1=^@(?!.*\\\\)$)&r2=m{2}&r3=^co.*').should.eql({\n        r1: '^@(?!.*\\\\)$)',\n        r2: 'm{2}',\n        r3: '^co.*'\n      });\n    })\n  });\n\n  describe('.stackTraceFilter()', function() {\n    describe('on node', function() {\n      var filter = utils.stackTraceFilter();\n      it('should get a stack-trace as a string and prettify it', function() {\n        var stack = [ 'AssertionError: foo bar'\n            , 'at EventEmitter.<anonymous> (/usr/local/dev/test.js:16:12)'\n            , 'at Context.<anonymous> (/usr/local/dev/test.js:19:5)'\n            , 'Test.Runnable.run (/usr/local/lib/node_modules/mocha/lib/runnable.js:244:7)'\n            , 'Runner.runTest (/usr/local/lib/node_modules/mocha/lib/runner.js:374:10)'\n            , '/usr/local/lib/node_modules/mocha/lib/runner.js:452:12'\n            , 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:299:14)'\n            , '/usr/local/lib/node_modules/mocha/lib/runner.js:309:7'\n            , 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:248:23)'\n            , 'Immediate._onImmediate (/usr/local/lib/node_modules/mocha/lib/runner.js:276:5)'\n            , 'at processImmediate [as _immediateCallback] (timers.js:321:17)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0,3).join('\\n'));\n\n        stack = [ 'AssertionError: bar baz'\n          , 'at /usr/local/dev/some-test-file.js:25:8'\n          , 'at tryCatcher (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/util.js:24:31)'\n          , 'at Promise._resolveFromResolver (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/promise.js:439:31)'\n          , 'at new Promise (/usr/local/dev/own/tmp/node_modules/bluebird/js/main/promise.js:53:37)'\n          , 'at yourFunction (/usr/local/dev/own/tmp/test1.js:24:13)'\n          , 'at Context.<anonymous> (/usr/local/dev/some-test-file:30:4)'\n          , 'Test.Runnable.run (/usr/local/lib/node_modules/mocha/lib/runnable.js:218:15)'\n          , 'next (/usr/local/lib/node_modules/mocha/lib/runner.js:248:23)'\n          , 'Immediate._onImmediate (/usr/local/lib/node_modules/mocha/lib/runner.js:276:5)'\n          , 'at processImmediate [as _immediateCallback] (timers.js:321:17)'];\n\n        filter(stack.join('\\n')).should.equal(stack.slice(0,7).join('\\n'));\n      });\n\n      it('does not ignore other bower_components and components', function() {\n        var stack = ['Error: failed'\n          , 'at assert (index.html:11:26)'\n          , 'at Context.<anonymous> (test.js:17:18)'\n          , 'at bower_components/should/should.js:4827:7'\n          , 'at next (file:///.../bower_components/should/should.js:4766:23)'\n          , 'at components/should/5.0.0/should.js:4827:7'\n          , 'at next (file:///.../components/should/5.0.0/should.js:4766:23)'\n          , 'at file:///.../bower_components/mocha/mocha.js:4794:5'\n          , 'at timeslice (.../components/mocha/mocha.js:6218:27)'\n          , 'at Test.require.register.Runnable.run (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4463:15)'\n          , 'at Runner.require.register.Runner.runTest (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4892:10)'\n          , 'at file:///.../components/mochajs/mocha/2.1.0/mocha.js:4970:12'\n          , 'at next (file:///.../components/mochajs/mocha/2.1.0/mocha.js:4817:14)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0,7).join('\\n'));\n      });\n    });\n\n    describe('on browser', function() {\n      var filter;\n      before(function() {\n        global.document = true;\n        global.location = { href: 'localhost:3000/foo/bar/index.html' };\n        filter = utils.stackTraceFilter();\n      });\n      it('does not strip out other bower_components and components', function() {\n        var stack = ['Error: failed'\n          , 'at assert (index.html:11:26)'\n          , 'at Context.<anonymous> (test.js:17:18)'\n          , 'at bower_components/should/should.js:4827:7'\n          , 'at next (bower_components/should/should.js:4766:23)'\n          , 'at components/should/5.0.0/should.js:4827:7'\n          , 'at next (components/should/5.0.0/should.js:4766:23)'\n          , 'at Runner.require.register.Runner.runTest (node_modules/mocha.js:4892:10)'\n          , 'at localhost:3000/foo/bar/node_modules/mocha.js:4970:12'\n          , 'at next (node_modules/mocha.js:4817:14)'];\n        filter(stack.join('\\n')).should.equal(stack.slice(0,7).join('\\n'));\n      });\n\n      after(function() {\n        delete global.document;\n        delete global.location;\n      });\n    });\n  });\n});\n"]},"hash":"d36ac78d0290fbc7d35af5fab8f99b97b140397c"}
